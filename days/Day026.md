
---
# Day026 — Ollamaで最小QAを通す（qwen2.5:7b）
日付: 2025-08-14（木）  
モード: 通常（※時間が無いときは「簡易モード：🎯⚙️🔁」だけ埋める）

## ⏱ フェーズ（チェックで進行管理）
- [ ] 祈り／願い（目的の言語化）
- [ ] 設計（分解・段取り）
- [ ] 実装（手を動かす）
- [ ] 振り返り（判断・教訓）
- [ ] 記録（公開に耐える形へ）

---

## 🎯 1. 今日のテーマ / 狙い（Why）
- ねらい: **OllamaでQA応答するBOT**をローカルで動かす（入力→応答の一連を通す）
- 成功条件（Doneの定義）: **質問に回答できることを確認**（最小QAがローカルで成立）
- 次の達成ライン: **`draft_today` の再現＋Rerank統合**
- 想定リスク・制約: **パッケージ/モデルの取り違え→入れ直しで時間損失**、PATH/ポート競合、日本語応答品質のばらつき、**ロック未整備によるバージョン揺れ（再現性低下）**

## 🧠 背景・思想
- 図解: **収集（チャンク更新） → Rerank（BM25→BGE/CE） → 再言語化（テンプレ） → HITL（Slack承認）**
- Bot構築作業の**続き**。Ollama を使い、**質問→解答**までをローカルで完結。
- （Day025の文脈）思考の言語化を機械に肩代わりさせる土台づくりの一環。継続発信の自動化へ。
- Bot構築作業の**続き**。Ollama を使い、**質問→解答**までをローカルで完結。
- （Day025の文脈）思考の言語化を機械に肩代わりさせる土台づくりの一環。継続発信の自動化へ。

## ⚙️ 2. 作業ログ（When/What）
> 出来事を箇条書きで。時刻は書かなくてOK。
- Ollama で **質問→解答** の動作を確認（最小QA）
- Python **3.13 → 3.12** にダウングレード（**torch**互換のため）
-

## 🧪 3. 試行と実装（How）
> 手順の要点のみ（長いコードは省略）。コードを書く場合は**コメントを英語**で。
- 使ったツール／技術: Ollama（**qwen2.5:7b**）
- 実行方法: **CLI（PowerShell）**／**Pythonスクリプト**
- 選定理由: ローカルで軽量にQA検証できるため（ネットワーク依存を減らす）
- 工夫・つまずき・発見:
  - つまずき: **torch と Python の互換調整**に時間。Python **3.13 → 3.12** へダウングレード。
  - メモ: 互換表の確認とロック更新が有効（後日付録に整理）。
- 結果（できた／できてない）:
  - **最小QAは動作**（Done達成）
  - テスト質問: 「環境構築とは？」「選択と接続のワザはどんなもの？」
  - 前者: **RAG**から根拠を取得して回答
  - 後者: **RAGに該当なし**のため、スタンドアロンで回答

## 📊 操作フェーズチェック
- **6 選択と接続**：ワザ＝**パスをつなぐ**（PATH/環境変数/モジュール探索を整理）
- **11 再帰的演算**：ワザ＝**リンク**（環境構築で主に使用）
  - **リンク**：2つのシステムが連動するように、信号のやりとりをつなげること
  - **環境構築**：複数のパッケージやライブラリ、外部システムとのインターフェースやドライバーを用意し、メインのシステムと連動できるように設定すること

## 🔁 洞察と考察
- **根拠提示の設計**：回答時に参照チャンクとスコアを**明示**（RAG有無も自己申告）
- **二段リランク**：BM25 → **BGE/CE** の基本線。デバイス制約でフォールバック規則を定義
- **最小sBOM**：依存名・版・ハッシュだけでも**保存**して配布・監査・再現に備える
- **気づき**：環境構築の本質は**リンク＋パス＋名前管理**に加えて、**バージョン管理**。呪文（インストール・起動コマンド）の列挙は**生成AIの補助**が有効。
- **現実との接続**：確実に品質を担保するには**sBOM（Software Bill of Materials）**のような**構成リスト**が要る。配布・引継ぎ・監査で効く。
- **見せ方／見られ方**：**lockファイル＋sBOM＋最小手順**をセットで出す。読む人は“何を入れたか／なぜか／どの順か”が一目で分かる。
- **問い直し**：呪文を毎回手で並べるより、**宣言的な環境定義**（pyproject.toml/lock/sBOM）を主にし、生成AIは**差分提案**と**確認**に使う。

## 🪶 雑記・気づき
-

## 🙏 感謝・引用
- 人 / ツール / 資料:
- 一言:

## 🛠 次の挑戦メモ（Next）
- **明日やること**
  - `draft_today` を**テンプレ付**で再現（**BGE/CE**比較ログを残す）
  - **Slack承認→公開**のミニ運用を通す
  - `poetry.lock` を更新・コミットし、**最小sBOM**を `/ops/` に保存
  - BOT機能の続き（バックエンド↔フロント連携）
  - フロント側のツイート生成：テンプレ／140字最適化／自動ハッシュタグ付与
  - Slack承認→X投稿の一連フローの雛形化
  - `draft_today` の再試行：実行ログ採取と**最小再現**の切り出し
  - **バージョン固定**（`poetry lock` の再生成とコミット）
  - **sBOM出力の検証**（ツール選定と最小出力）
- **まだ引っかかっていること**
  - **pipx**の使い方（PATH/`ensurepath`/Poetryとの棲み分け）
  - 調査情報の**集約**方法：限定クローラー（範囲・頻度・要約スキーマ）
- **ブロッカーと回避策**
  - pipxが詰まる → 当面は `python -m pip` ＋ Poetry scripts で代替
  - モデル未接続 → LM Studio やAPIベースへ一時スイッチ（設定は抽象化して差し替え可能に）
  - sBOMツール選定で迷う → **最小**（依存名＋バージョン＋ハッシュ）から先に決め、後で拡張

## 📝 タイトル
- Ollamaで最小QAを通す（qwen2.5:7b）

## 🏷 タグ
#Ollama #qwen2.5 #Python #PowerShell #RAG

